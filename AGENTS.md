# Repository Guide for Codex CLI

## Project overview
This is a Next.js 14 App Router site with React 18, TypeScript (strict), Tailwind CSS, and shadcn/ui. Routes live in `src/app`, and view components are in `src/views`. Global styles load from `src/app/globals.css`. Layouts are defined in `src/app/(site)/layout.tsx` and `src/app/(minimal)/layout.tsx`.

## Key directories and source of truth
- `src/app`: route-level pages, layouts, and metadata.
- `src/views`: route-level view components consumed by app routes.
- `src/components`: reusable UI and layout; `src/components/ui` is the shadcn/ui layer.
- `src/hooks`: shared hooks like `useIsMobile`, `useScrollToTop`, and analytics helpers.
- `src/lib`: utilities, analytics, SEO helpers, structured data, date utilities, constants.
- `src/data`: static content (blog posts, events, amazon reviews, FAQs).
- `public`: static assets, redirects, and `lovable-uploads` image folder.

## Local commands
- `npm run dev`: Next.js dev server.
- `npm run build`: production build.
- `npm run start`: serve production build locally.
- `npm run lint`: ESLint on the full repo.

## Routing and layout
- Routes live in `src/app`. `src/app/(site)/layout.tsx` adds `Navbar` and `Footer`.
- `DrNjo` uses the `(minimal)` route group.
- Legacy URL redirects are in `public/_redirects` (portable) and `vercel.json` (Vercel host redirects).
- Add new routes to `src/lib/routeBreadcrumbs.ts` for breadcrumb data.

## Content management
- Blog posts: `src/data/blogPosts.ts` (Markdown-in-strings, optional embedded HTML).
  - Required fields: `id`, `title`, `excerpt`, `category`, `date` (YYYY-MM-DD), `readTime`, `slug`, `author`.
  - Optional fields: `featuredImage`, `featuredImageAlt`, `featuredImageFit`, `series`.
  - Dev-only internal link validation runs via `src/lib/linkValidation.ts`; `/blog/...` links must match slugs.
- Events: `src/data/events.ts` (date strings like "March 28, 2025"; optional `dateDisplay` for ranges).
- Testimonials: inline in `src/views/Testimonials.tsx`.
- Amazon reviews: `src/data/amazonReviews.ts`.
- Business contact info: `src/lib/constants.ts` and `src/lib/siteMetadata.ts`.

## Blog system behavior
- Listing page: `src/views/Blog.tsx` with `?search=` query param.
- Post page: `src/views/BlogPost.tsx` uses `marked` and `dangerouslySetInnerHTML`.
  - Content is split on blank lines, so avoid extra blank lines inside HTML blocks.
  - Do not introduce untrusted HTML (no sanitization is applied).
- Series navigation uses `post.series` and `getSeriesPosts`.
- Related posts are filtered by category and left in array order (no recency sort).
- Use `formatLocalDate` for display to avoid timezone shifts.

## SEO and structured data
- `src/lib/seo.ts` builds metadata; `src/components/StructuredData.tsx` renders JSON-LD.
- `src/lib/structuredData.ts` includes schemas for blog posts, events, and contact.
- Canonical host is controlled by `NEXT_PUBLIC_CANONICAL_SITE_URL` in `src/lib/siteMetadata.ts`.
- Search schema targets `/blog` via `SITE_SEARCH_PATH`.

## Analytics
- `useAnalytics` injects GA + Hotjar only in production on the canonical host.
- `useGoogleAnalytics` tracks SPA page views.
- Custom events in `src/lib/analytics.ts` (blog views, CTAs, series navigation).

## Styling and UI conventions
- Tailwind is primary; extend tokens in `tailwind.config.ts` (primary is `#06437A`).
- Global styles and utilities live in `src/app/globals.css` under Tailwind layers.
- Common layout helpers: `Section`, `SectionTitle`, `SectionSubtitle`.
- Fonts are loaded in `src/app/globals.css` (Inter and Montserrat).
- Use the `@` alias for `src` imports.

## Assets
- Use `/lovable-uploads/...` for local assets in `public/lovable-uploads`.
- External image URLs are allowed; include meaningful `alt` text.
- `featuredImageFit` supports `"cover"` or `"contain"` for blog posts.

## Build and deployment notes
- The build defines `NEXT_PUBLIC_BUILD_TIMESTAMP` in `next.config.mjs`.
- Sitemap and robots are generated by `src/app/sitemap.ts` and `src/app/robots.ts`.

## Coding style and naming
- TypeScript only; 2-space indentation; functional components.
- PascalCase component filenames; hooks start with `use`.
- Prefer `cn` for class merging and shadcn patterns for variants.

## Testing and verification
- No automated tests yet. If you add tests, use `.test.ts(x)` next to source files.
- For UI changes, manually verify key routes: `/`, `/blog`, `/blog/:slug`, `/events`, `/contact`.

## Commit and PR guidelines
- Commit messages: short, imperative (e.g., "Fix blog post runtime error").
- PRs should describe user-facing changes and list verification steps.
